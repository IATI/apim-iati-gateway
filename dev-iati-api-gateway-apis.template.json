{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "ApimServiceName": {
      "type": "string"
    }
  },
  "resources": [
    {
      "properties": {
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "2",
        "isCurrent": true,
        "apiRevisionDescription": "v2.00 - DEL route removed",
        "subscriptionRequired": true,
        "displayName": "Echo API",
        "serviceUrl": "http://echoapi.cloudapp.net/api",
        "path": "echo",
        "protocols": [
          "https"
        ]
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": []
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "A demonstration of a POST call based on the echo backend above. The request body is expected to contain JSON-formatted data (see example below). A policy is used to automatically transform any request sent in JSON directly to XML. In a real-world scenario this could be used to enable modern clients to speak to a legacy backend.",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": [
            {
              "contentType": "application/json",
              "sample": "{\r\n\t\"vehicleType\": \"train\",\r\n\t\"maxSpeed\": 125,\r\n\t\"avgSpeed\": 90,\r\n\t\"speedUnit\": \"mph\"\r\n}"
            }
          ]
        },
        "responses": [
          {
            "statusCode": 200,
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "Create resource",
        "method": "POST",
        "urlTemplate": "/resource"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/create-resource')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<json-to-xml apply=\"always\" consider-accept-header=\"false\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t</outbound>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/create-resource/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'echo-api', 'create-resource')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "A demonstration of a PUT call handled by the same \"echo\" backend as above. You can now specify a request body in addition to headers and it will be returned as well.",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "Modify Resource",
        "method": "PUT",
        "urlTemplate": "/resource"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/modify-resource')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "The HEAD operation returns only headers. In this demonstration a policy is used to set additional headers when the response is returned and to enable JSONP.",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "Retrieve header only",
        "method": "HEAD",
        "urlTemplate": "/resource"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/retrieve-header-only')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t\t<set-header name=\"X-My-Sample\" exists-action=\"override\">\r\n\t\t\t<value>This is a sample</value>\r\n\t\t\t<!-- for multiple headers with the same name add additional value elements -->\r\n\t\t</set-header>\r\n\t\t<jsonp callback-parameter-name=\"ProcessResponse\" />\r\n\t</outbound>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/retrieve-header-only/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'echo-api', 'retrieve-header-only')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "A demonstration of a GET call on a sample resource. It is handled by an \"echo\" backend which returns a response equal to the request (the supplied headers and body are being returned as received).",
        "request": {
          "queryParameters": [
            {
              "name": "param1",
              "description": "A sample parameter that is required and has a default value of \"sample\".",
              "type": "string",
              "defaultValue": "sample",
              "required": true,
              "values": [
                "sample"
              ]
            },
            {
              "name": "param2",
              "description": "Another sample parameter, set to not required.",
              "type": "number",
              "required": false,
              "values": []
            }
          ],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "description": "Returned in all cases.",
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "Retrieve resource",
        "method": "GET",
        "urlTemplate": "/resource"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/retrieve-resource')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "A demonstration of a GET call with caching enabled on the same \"echo\" backend as above. Cache TTL is set to 1 hour. When you make the first request the headers you supplied will be cached. Subsequent calls will return the same headers as the first time even if you change them in your request.",
        "request": {
          "queryParameters": [
            {
              "name": "param1",
              "description": "A sample parameter that is required and has a default value of \"sample\".",
              "type": "string",
              "defaultValue": "sample",
              "required": true,
              "values": [
                "sample"
              ]
            },
            {
              "name": "param2",
              "description": "Another sample parameter, set to not required.",
              "type": "string",
              "required": false,
              "values": []
            }
          ],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "Retrieve resource (cached)",
        "method": "GET",
        "urlTemplate": "/resource-cached"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/retrieve-resource-cached')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<cache-lookup vary-by-developer=\"false\" vary-by-developer-groups=\"false\">\r\n\t\t\t<vary-by-header>Accept</vary-by-header>\r\n\t\t\t<vary-by-header>Accept-Charset</vary-by-header>\r\n\t\t</cache-lookup>\r\n\t\t<rewrite-uri template=\"/resource\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t\t<cache-store duration=\"3600\" />\r\n\t</outbound>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/echo-api/retrieve-resource-cached/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'echo-api', 'retrieve-resource-cached')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/starter/echo-api')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/unlimited/echo-api')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'echo-api')]"
      ]
    },
    {
      "properties": {
        "description": "The IATI Registry is the place to register your organisation and IATI datasets.",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": false,
        "displayName": "IATI Registry",
        "serviceUrl": "https://iatiregistry.org/api/3",
        "path": "registry",
        "protocols": [
          "https"
        ]
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-registry')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": []
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "Return the details of a publisher. When the authorisation header and include_datasets parameter are provided, the call also returns private datasets.",
        "request": {
          "queryParameters": [
            {
              "name": "id",
              "description": "the id or name of the publisher",
              "type": "string",
              "required": true,
              "values": []
            }
          ],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "Publisher Details",
        "method": "GET",
        "urlTemplate": "/action/organization_show"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-registry/publisher-details')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-registry')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "Return a list of the names of IATI publishers. When the authorisation header is provided and the user has sysadmin privileges, the call also returns publishers with a Pending status.",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "description": "",
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "Publisher List",
        "method": "GET",
        "urlTemplate": "/action/organization_list"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-registry/organisation-list')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-registry')]"
      ]
    },
    {
      "properties": {
        "displayName": "organisation"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-registry/organisation-list/organisation')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/tags",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'iati-registry', 'organisation-list')]"
      ]
    },
    {
      "properties": {
        "displayName": "publish"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-registry/publish')]",
      "type": "Microsoft.ApiManagement/service/apis/tags",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-registry')]"
      ]
    },
    {
      "properties": {
        "displayName": "registry"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-registry/registry')]",
      "type": "Microsoft.ApiManagement/service/apis/tags",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-registry')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/no-authentication/iati-registry')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-registry')]"
      ]
    },
    {
      "properties": {
        "description": "The IATI Validator Public API is a tool for checking if data aligns with the rules and guidance of IATI Standard. It allows users to check and improve the quality of IATI data to ensure it is accessible and useful to anyone working with data on development and humanitarian resources and results.",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": true,
        "displayName": "IATI Validator",
        "path": "validator",
        "protocols": [
          "https"
        ]
      },
      "name": "[concat(parameters('ApimServiceName'), '/file-validator')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": []
    },
    {
      "properties": {
        "contentType": "application/vnd.oai.openapi.components+json",
        "document": {
          "components": {
            "schemas": {
              "valid IATI organisations file validation report": {
                "type": "object",
                "properties": {
                  "schemaVersion": {
                    "type": "string"
                  },
                  "iatiVersion": {
                    "type": "string"
                  },
                  "summary": {
                    "type": "object",
                    "properties": {
                      "critical": {
                        "type": "integer"
                      },
                      "danger": {
                        "type": "integer"
                      },
                      "warning": {
                        "type": "integer"
                      },
                      "info": {
                        "type": "integer"
                      },
                      "success": {
                        "type": "integer"
                      }
                    }
                  },
                  "filetype": {
                    "type": "string"
                  },
                  "validation": {
                    "type": "string"
                  },
                  "feedback": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "category": {
                          "type": "string"
                        },
                        "label": {
                          "type": "string"
                        },
                        "messages": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "text": {
                                "type": "string"
                              },
                              "rulesets": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "src": {
                                      "type": "string"
                                    },
                                    "severity": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "src",
                                    "severity"
                                  ]
                                }
                              },
                              "context": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "text": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "text"
                                  ]
                                }
                              }
                            },
                            "required": [
                              "id",
                              "text",
                              "rulesets",
                              "context"
                            ]
                          }
                        }
                      },
                      "required": [
                        "category",
                        "label",
                        "messages"
                      ]
                    }
                  },
                  "organisations": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "title": {
                          "type": "string"
                        },
                        "identifier": {
                          "type": "string"
                        },
                        "publisher": {
                          "type": "string"
                        },
                        "feedback": {
                          "type": "array"
                        }
                      },
                      "required": [
                        "title",
                        "identifier",
                        "publisher",
                        "feedback"
                      ]
                    }
                  }
                }
              },
              "valid IATI activities file validation report": {
                "type": "object",
                "properties": {
                  "schemaVersion": {
                    "type": "string"
                  },
                  "iatiVersion": {
                    "type": "string"
                  },
                  "summary": {
                    "type": "object",
                    "properties": {
                      "critical": {
                        "type": "integer"
                      },
                      "danger": {
                        "type": "integer"
                      },
                      "warning": {
                        "type": "integer"
                      },
                      "info": {
                        "type": "integer"
                      },
                      "success": {
                        "type": "integer"
                      }
                    }
                  },
                  "filetype": {
                    "type": "string"
                  },
                  "validation": {
                    "type": "string"
                  },
                  "feedback": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "category": {
                          "type": "string"
                        },
                        "label": {
                          "type": "string"
                        },
                        "messages": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "text": {
                                "type": "string"
                              },
                              "rulesets": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "src": {
                                      "type": "string"
                                    },
                                    "severity": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "src",
                                    "severity"
                                  ]
                                }
                              },
                              "context": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "text": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "text"
                                  ]
                                }
                              }
                            },
                            "required": [
                              "id",
                              "text",
                              "rulesets",
                              "context"
                            ]
                          }
                        }
                      },
                      "required": [
                        "category",
                        "label",
                        "messages"
                      ]
                    }
                  },
                  "activities": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "title": {
                          "type": "string"
                        },
                        "identifier": {
                          "type": "string"
                        },
                        "publisher": {
                          "type": "string"
                        },
                        "feedback": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "category": {
                                "type": "string"
                              },
                              "label": {
                                "type": "string"
                              },
                              "messages": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "id": {
                                      "type": "string"
                                    },
                                    "text": {
                                      "type": "string"
                                    },
                                    "rulesets": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "src": {
                                            "type": "string"
                                          },
                                          "severity": {
                                            "type": "string"
                                          },
                                          "href": {
                                            "type": "string"
                                          }
                                        },
                                        "required": [
                                          "src",
                                          "severity",
                                          "href"
                                        ]
                                      }
                                    },
                                    "context": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "text": {
                                            "type": "string"
                                          }
                                        },
                                        "required": [
                                          "text"
                                        ]
                                      }
                                    }
                                  },
                                  "required": [
                                    "id",
                                    "text",
                                    "rulesets",
                                    "context"
                                  ]
                                }
                              }
                            },
                            "required": [
                              "category",
                              "label",
                              "messages"
                            ]
                          }
                        }
                      },
                      "required": [
                        "title",
                        "identifier",
                        "publisher",
                        "feedback"
                      ]
                    }
                  }
                }
              },
              "0.6.1 Unsupported IATI Version": {
                "type": "object",
                "properties": {
                  "schemaVersion": {
                    "type": "string"
                  },
                  "iatiVersion": {
                    "type": "string"
                  },
                  "summary": {
                    "type": "object",
                    "properties": {
                      "critical": {
                        "type": "integer"
                      },
                      "danger": {
                        "type": "integer"
                      },
                      "warning": {
                        "type": "integer"
                      },
                      "info": {
                        "type": "integer"
                      },
                      "success": {
                        "type": "integer"
                      }
                    }
                  },
                  "filetype": {
                    "type": "string"
                  },
                  "validation": {
                    "type": "string"
                  },
                  "feedback": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "category": {
                          "type": "string"
                        },
                        "label": {
                          "type": "string"
                        },
                        "messages": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string"
                              },
                              "text": {
                                "type": "string"
                              },
                              "rulesets": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "src": {
                                      "type": "string"
                                    },
                                    "severity": {
                                      "type": "string"
                                    },
                                    "href": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "src",
                                    "severity",
                                    "href"
                                  ]
                                }
                              },
                              "context": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "text": {
                                      "type": "string"
                                    }
                                  },
                                  "required": [
                                    "text"
                                  ]
                                }
                              }
                            },
                            "required": [
                              "id",
                              "text",
                              "rulesets",
                              "context"
                            ]
                          }
                        }
                      },
                      "required": [
                        "category",
                        "label",
                        "messages"
                      ]
                    }
                  }
                }
              }
            }
          }
        }
      },
      "name": "[concat(parameters('ApimServiceName'), '/file-validator/1614776851404')]",
      "type": "Microsoft.ApiManagement/service/apis/schemas",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'file-validator')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "Endpoint to send a full IATI File (either organisations or activities) and receive a JSON validation report.",
        "request": {
          "description": "IATI xml file",
          "queryParameters": [],
          "headers": [
            {
              "name": "Accept",
              "description": "Indicates the type of response",
              "type": "string",
              "defaultValue": "application/json",
              "required": false,
              "values": [
                "application/json"
              ]
            },
            {
              "name": "Content-Type",
              "description": "Indicates the media type of the resource",
              "type": "string",
              "defaultValue": "application/xml",
              "required": false,
              "values": [
                "application/xml"
              ]
            }
          ],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 422,
            "description": "If no body is provided or it's in the wrong format",
            "headers": [],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\n    \"error\": \"No body\"\n}   "
              },
              {
                "contentType": "application/json",
                "sample": "{\n    \"error\": \"Body must be a string\"\n}   "
              }
            ]
          },
          {
            "statusCode": 200,
            "description": "When the XML file is successfully processed by the IATI Validator it returns a JSON validation report.",
            "headers": [
              {
                "name": "Content-Type",
                "description": "Content type of the response",
                "type": "string",
                "defaultValue": "application/json",
                "required": false,
                "values": [
                  "application/json"
                ]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\n    \"schemaVersion\": \"1.0.1\",\n    \"iatiVersion\": \"2.02\",\n    \"summary\": {\n        \"critical\": 0,\n        \"danger\": 0,\n        \"warning\": 0,\n        \"info\": 0,\n        \"success\": 0\n    },\n    \"filetype\": \"iati-organisations\",\n    \"validation\": \"ok\",\n    \"feedback\": [\n        {\n            \"category\": \"iati\",\n            \"label\": \"IATI file\",\n            \"messages\": [\n                {\n                    \"id\": \"0.0.1\",\n                    \"text\": \"Congratulations! This IATI file has successfully passed IATI XML schema validation with no errors!\",\n                    \"rulesets\": [\n                        {\n                            \"src\": \"iati\",\n                            \"severity\": \"success\"\n                        }\n                    ],\n                    \"context\": [\n                        {\n                            \"text\": \"\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ],\n    \"organisations\": [\n        {\n            \"title\": \"Test Org Nepal\",\n            \"identifier\": \"NP-SWC-1234\",\n            \"publisher\": \"NP-SWC-1234\",\n            \"feedback\": []\n        }\n    ]\n}   ",
                "schemaId": "1614776851404",
                "typeName": "valid IATI organisations file validation report"
              },
              {
                "contentType": "application/json",
                "sample": "{\n    \"schemaVersion\": \"1.0.1\",\n    \"iatiVersion\": \"2.03\",\n    \"summary\": {\n        \"critical\": 0,\n        \"danger\": 0,\n        \"warning\": 1,\n        \"info\": 0,\n        \"success\": 0\n    },\n    \"filetype\": \"iati-activities\",\n    \"validation\": \"ok\",\n    \"feedback\": [\n        {\n            \"category\": \"iati\",\n            \"label\": \"IATI file\",\n            \"messages\": [\n                {\n                    \"id\": \"0.0.1\",\n                    \"text\": \"Congratulations! This IATI file has successfully passed IATI XML schema validation with no errors!\",\n                    \"rulesets\": [\n                        {\n                            \"src\": \"iati\",\n                            \"severity\": \"success\"\n                        }\n                    ],\n                    \"context\": [\n                        {\n                            \"text\": \"\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ],\n    \"activities\": [\n        {\n            \"title\": \"Activity title\",\n            \"identifier\": \"AA-AAA-123456789-ABC123\",\n            \"publisher\": \"AA-AAA-123456789\",\n            \"feedback\": [\n                {\n                    \"category\": \"identifiers\",\n                    \"label\": \"Identification\",\n                    \"messages\": [\n                        {\n                            \"id\": \"1.14.8\",\n                            \"text\": \"The reporting-org identifier must start with an approved agency code.\",\n                            \"rulesets\": [\n                                {\n                                    \"src\": \"iati\",\n                                    \"severity\": \"warning\",\n                                    \"href\": \"https://iatistandard.org/en/guidance/preparing-organisation/organisation-account/how-to-create-your-iati-organisation-identifier/\"\n                                }\n                            ],\n                            \"context\": [\n                                {\n                                    \"text\": \"In reporting-org AA-AAA-123456789\"\n                                }\n                            ]\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}",
                "schemaId": "1614776851404",
                "typeName": "valid IATI activities file validation report"
              },
              {
                "contentType": "application/json",
                "sample": "{\n    \"schemaVersion\": \"\",\n    \"iatiVersion\": \"\",\n    \"summary\": {\n        \"critical\": 0,\n        \"danger\": 1,\n        \"warning\": 0,\n        \"info\": 0,\n        \"success\": 0\n    },\n    \"filetype\": \"iati-activities\",\n    \"validation\": \"ok\",\n    \"feedback\": [\n        {\n            \"category\": \"documents\",\n            \"label\": \"Related documents\",\n            \"messages\": [\n                {\n                    \"id\": \"0.6.1\",\n                    \"text\": \"Version 1.03 of the IATI Standard is no longer supported. Please use version 2.\",\n                    \"rulesets\": [\n                        {\n                            \"src\": \"iati\",\n                            \"severity\": \"danger\",\n                            \"href\": \"https://iatistandard.org/en/news/notice-iati-standard-version-1-is-deprecated/\"\n                        }\n                    ],\n                    \"context\": [\n                        {\n                            \"text\": \"\"\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n}",
                "schemaId": "1614776851404",
                "typeName": "0.6.1 Unsupported IATI Version"
              }
            ]
          }
        ],
        "displayName": "validate",
        "method": "POST",
        "urlTemplate": "/validate"
      },
      "name": "[concat(parameters('ApimServiceName'), '/file-validator/post-pub-validate-post')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'file-validator')]",
        "[resourceId('Microsoft.ApiManagement/service/apis/schemas', parameters('ApimServiceName'), 'file-validator', '1614776851404')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<set-backend-service id=\"apim-generated-policy\" backend-id=\"dev-func-iati-validator\" />\r\n\t\t<rewrite-uri template=\"/pub/validate\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t</outbound>\r\n\t<on-error>\r\n\t\t<base />\r\n\t</on-error>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/file-validator/post-pub-validate-post/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'file-validator', 'post-pub-validate-post')]"
      ]
    },
    {
      "properties": {
        "displayName": "validator"
      },
      "name": "[concat(parameters('ApimServiceName'), '/file-validator/validator')]",
      "type": "Microsoft.ApiManagement/service/apis/tags",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'file-validator')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/starter/file-validator')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'file-validator')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/unlimited/file-validator')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'file-validator')]"
      ]
    },
    {
      "properties": {
        "description": "Import from \"dev-func-iati-validator\" Function App",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": false,
        "displayName": "IATI Validator Private",
        "path": "pvt/validator",
        "protocols": [
          "https"
        ]
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-private')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": []
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get",
        "method": "GET",
        "urlTemplate": "/pvt"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-private/get-pvt-get')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-private')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<set-backend-service id=\"apim-generated-policy\" backend-id=\"dev-func-iati-validator\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t</outbound>\r\n\t<on-error>\r\n\t\t<base />\r\n\t</on-error>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-private/get-pvt-get/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'iati-validator-private', 'get-pvt-get')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/private-routes/iati-validator-private')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-private')]"
      ]
    },
    {
      "properties": {
        "description": "Get an existing validation report of a published IATI doc known to the IATI Registry by passing either the id, hash or URL of the document, as available from the Registry API.",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": false,
        "displayName": "Validator Services",
        "path": "validator-services",
        "protocols": [
          "https"
        ]
      },
      "name": "[concat(parameters('ApimServiceName'), '/dev-func-validator-services')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": []
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pub-get-report",
        "method": "GET",
        "urlTemplate": "/pub/validation/existing"
      },
      "name": "[concat(parameters('ApimServiceName'), '/dev-func-validator-services/get-pub-get-report')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'dev-func-validator-services')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<set-backend-service id=\"apim-generated-policy\" backend-id=\"dev-func-validator-services\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t</outbound>\r\n\t<on-error>\r\n\t\t<base />\r\n\t</on-error>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/dev-func-validator-services/get-pub-get-report/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'dev-func-validator-services', 'get-pub-get-report')]"
      ]
    },
    {
      "properties": {
        "displayName": "validator"
      },
      "name": "[concat(parameters('ApimServiceName'), '/dev-func-validator-services/validator')]",
      "type": "Microsoft.ApiManagement/service/apis/tags",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'dev-func-validator-services')]"
      ]
    },
    {
      "properties": {
        "description": "Import from \"dev-func-validator-services\" Function App",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": true,
        "displayName": "Validator Services Private",
        "path": "dev-func-validator-services-private",
        "protocols": [
          "https"
        ]
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2019-01-01",
      "dependsOn": []
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pub-get-report",
        "method": "GET",
        "urlTemplate": "/pub/validation/existing"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-report')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<set-backend-service id=\"apim-generated-policy\" backend-id=\"dev-func-validator-services\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t</outbound>\r\n\t<on-error>\r\n\t\t<base />\r\n\t</on-error>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-report/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pub-get-report')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get",
        "method": "GET",
        "urlTemplate": "/pvt/"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "<policies>\r\n\t<inbound>\r\n\t\t<base />\r\n\t\t<set-backend-service id=\"apim-generated-policy\" backend-id=\"dev-func-validator-services\" />\r\n\t</inbound>\r\n\t<backend>\r\n\t\t<base />\r\n\t</backend>\r\n\t<outbound>\r\n\t\t<base />\r\n\t</outbound>\r\n\t<on-error>\r\n\t\t<base />\r\n\t</on-error>\r\n</policies>",
        "format": "rawxml"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2019-01-01",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pvt-get')]"
      ]
    }
  ]
}