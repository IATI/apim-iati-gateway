{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "ApimServiceName": {
      "type": "string"
    },
    "PolicyXMLBaseUrl": {
      "type": "string"
    },
    "serviceUrl": {
      "type": "object"
    }
  },
  "resources": [
    {
      "properties": {
        "description": "IATI's public validation API. Provides routes related to the validation of IATI XML.",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": true,
        "displayName": "IATI Validator",
        "serviceUrl": "[parameters('serviceUrl').iativalidatorv2]",
        "path": "validator",
        "protocols": ["https"]
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": []
    },
    {
      "properties": {
        "contentType": "application/vnd.oai.openapi.components+json",
        "document": {
          "components": {
            "schemas": {
              "No Body Error": {
                "type": "object",
                "properties": {
                  "error": {
                    "type": "string"
                  }
                },
                "example": {
                  "error": "No body"
                }
              },
              "Malformed Body Error": {
                "type": "object",
                "properties": {
                  "error": {
                    "type": "string"
                  }
                },
                "example": {
                  "error": "Body must be an application/xml string"
                }
              },
              "Validation Report Ad Hoc Validate": {
                "type": "object",
                "required": [
                  "valid",
                  "fileType",
                  "iatiVersion",
                  "rulesetCommitSha",
                  "codelistCommitSha",
                  "orgIdPrefixFileName",
                  "apiVersion",
                  "summary",
                  "errors"
                ],
                "properties": {
                  "valid": {
                    "type": "boolean",
                    "description": "Files with no critical severity errors are considered valid"
                  },
                  "fileType": {
                    "type": "string",
                    "description": "The type of IATI file",
                    "enum": ["iati-activities", "iati-organisations"]
                  },
                  "iatiVersion": {
                    "type": "string",
                    "description": "Version of the IATI Standard of the file",
                    "examples": ["2.01", "2.02", "2.03"]
                  },
                  "rulesetCommitSha": {
                    "type": "string",
                    "description": "git commit sha of the ruleset used to create the validation report"
                  },
                  "codelistCommitSha": {
                    "type": "string",
                    "description": "git commit sha of the codelist rules used to create the validation report"
                  },
                  "orgIdPrefixFileName": {
                    "type": "string",
                    "description": "file name of org id prefixes from https://org-id.guide/download.json"
                  },
                  "apiVersion": {
                    "type": "string",
                    "description": "version of the validator api"
                  },
                  "summary": {
                    "type": "object",
                    "required": ["critical", "error", "warning"],
                    "properties": {
                      "critical": {
                        "type": "integer",
                        "description": "Number of critical level validation errors with the file"
                      },
                      "error": {
                        "type": "integer",
                        "description": "Number of error level validation errors with the file"
                      },
                      "warning": {
                        "type": "integer",
                        "description": "Number of warning level validation errors with the file"
                      }
                    }
                  },
                  "errors": {
                    "type": "array",
                    "description": "array of errors, if empty the file has no errors",
                    "items": {
                      "type": "object",
                      "properties": {
                        "errors": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "errors": {
                                "type": "array",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "id": {
                                      "type": "string",
                                      "description": "The unique identifier of the error",
                                      "examples": ["9.26.1", "9.42.1"]
                                    },
                                    "severity": {
                                      "type": "string",
                                      "enum": ["critical", "danger", "warning"],
                                      "description": "The severity level of the error"
                                    },
                                    "message": {
                                      "type": "string",
                                      "description": "The informational message about the validation error"
                                    },
                                    "codelist": {
                                      "type": "string",
                                      "description": "The codelist that is being validated against (if applicable)",
                                      "examples": [
                                        "OrganisationRole",
                                        "DescriptionType",
                                        "ActivityDateType"
                                      ]
                                    },
                                    "context": {
                                      "type": "array",
                                      "items": {
                                        "type": "object",
                                        "properties": {
                                          "text": {
                                            "type": "string",
                                            "description": "The context of the error",
                                            "examples": [
                                              "\"25\" is not a valid value for attribute @code"
                                            ]
                                          }
                                        },
                                        "required": ["text"]
                                      }
                                    }
                                  },
                                  "required": [
                                    "id",
                                    "severity",
                                    "message",
                                    "context"
                                  ]
                                }
                              },
                              "category": {
                                "type": "string",
                                "enum": [
                                  "identifiers",
                                  "organisation",
                                  "information",
                                  "participating",
                                  "geo",
                                  "classifications",
                                  "financial",
                                  "documents",
                                  "relations",
                                  "performance"
                                ],
                                "description": "The category of the validation error"
                              }
                            },
                            "required": ["errors", "category"]
                          }
                        },
                        "identifier": {
                          "type": "string",
                          "description": "The activity's iati-identifier for iati-activities files, organisation-identifier for iati-organisations file, or 'file' for file level errors"
                        },
                        "title": {
                          "type": "string",
                          "description": "The activity's title for iati-activities files, the organisation name for iati-organisations files, or 'File level errors' for file level errors"
                        }
                      },
                      "required": ["errors", "identifier", "title"]
                    }
                  }
                },
                "example": {
                  "valid": false,
                  "fileType": "string",
                  "iatiVersion": "string",
                  "rulesetCommitSha": "string",
                  "codelistCommitSha": "string",
                  "orgIdPrefixFileName": "string",
                  "apiVersion": "string",
                  "summary": {
                    "critical": 0,
                    "error": 0,
                    "warning": 0
                  },
                  "errors": [
                    {
                      "errors": [
                        {
                          "errors": [
                            {
                              "id": "string",
                              "severity": "string",
                              "message": "string",
                              "codelist": "string",
                              "context": [
                                {
                                  "text": "string"
                                }
                              ]
                            }
                          ],
                          "category": "string"
                        }
                      ],
                      "identifier": "string",
                      "title": "string"
                    }
                  ]
                }
              },
              "Validation Report Published File": {
                "type": "object",
                "required": [
                  "registry_hash",
                  "registry_id",
                  "document_url",
                  "valid",
                  "report"
                ],
                "properties": {
                  "registry_hash": {
                    "type": "string",
                    "description": "hash of the file as defined by the IATI registry"
                  },
                  "registry_id": {
                    "type": "string",
                    "description": "id of the file as defined by the IATI registry"
                  },
                  "document_url": {
                    "type": "string",
                    "description": "url of the file as defined in the IATI registry"
                  },
                  "valid": {
                    "type": "boolean",
                    "description": "Files with no critical severity errors are considered valid"
                  },
                  "report": {
                    "type": "object",
                    "required": [
                      "valid",
                      "fileType",
                      "iatiVersion",
                      "rulesetCommitSha",
                      "codelistCommitSha",
                      "orgIdPrefixFileName",
                      "apiVersion",
                      "summary",
                      "errors"
                    ],
                    "properties": {
                      "valid": {
                        "type": "boolean",
                        "description": "Files with no critical severity errors are considered valid"
                      },
                      "fileType": {
                        "type": "string",
                        "description": "The type of IATI file",
                        "enum": ["iati-activities", "iati-organisations"]
                      },
                      "iatiVersion": {
                        "type": "string",
                        "description": "Version of the IATI Standard of the file",
                        "examples": ["2.01", "2.02", "2.03"]
                      },
                      "rulesetCommitSha": {
                        "type": "string",
                        "description": "git commit sha of the ruleset used to create the validation report"
                      },
                      "codelistCommitSha": {
                        "type": "string",
                        "description": "git commit sha of the codelist rules used to create the validation report"
                      },
                      "orgIdPrefixFileName": {
                        "type": "string",
                        "description": "file name of org id prefixes from https://org-id.guide/download.json"
                      },
                      "apiVersion": {
                        "type": "string",
                        "description": "version of the validator api"
                      },
                      "summary": {
                        "type": "object",
                        "required": ["critical", "error", "warning"],
                        "properties": {
                          "critical": {
                            "type": "integer",
                            "description": "Number of critical level validation errors with the file"
                          },
                          "error": {
                            "type": "integer",
                            "description": "Number of error level validation errors with the file"
                          },
                          "warning": {
                            "type": "integer",
                            "description": "Number of warning level validation errors with the file"
                          }
                        }
                      },
                      "errors": {
                        "type": "array",
                        "description": "array of errors, if empty the file has no errors",
                        "items": {
                          "type": "object",
                          "properties": {
                            "errors": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "errors": {
                                    "type": "array",
                                    "items": {
                                      "type": "object",
                                      "properties": {
                                        "id": {
                                          "type": "string",
                                          "description": "The unique identifier of the error",
                                          "examples": ["9.26.1", "9.42.1"]
                                        },
                                        "severity": {
                                          "type": "string",
                                          "enum": [
                                            "critical",
                                            "danger",
                                            "warning"
                                          ],
                                          "description": "The severity level of the error"
                                        },
                                        "message": {
                                          "type": "string",
                                          "description": "The informational message about the validation error"
                                        },
                                        "codelist": {
                                          "type": "string",
                                          "description": "The codelist that is being validated against (if applicable)",
                                          "examples": [
                                            "OrganisationRole",
                                            "DescriptionType",
                                            "ActivityDateType"
                                          ]
                                        },
                                        "context": {
                                          "type": "array",
                                          "items": {
                                            "type": "object",
                                            "properties": {
                                              "text": {
                                                "type": "string",
                                                "description": "The context of the error",
                                                "examples": [
                                                  "\"25\" is not a valid value for attribute @code"
                                                ]
                                              }
                                            },
                                            "required": ["text"]
                                          }
                                        }
                                      },
                                      "required": [
                                        "id",
                                        "severity",
                                        "message",
                                        "context"
                                      ]
                                    }
                                  },
                                  "category": {
                                    "type": "string",
                                    "enum": [
                                      "identifiers",
                                      "organisation",
                                      "information",
                                      "participating",
                                      "geo",
                                      "classifications",
                                      "financial",
                                      "documents",
                                      "relations",
                                      "performance"
                                    ],
                                    "description": "The category of the validation error"
                                  }
                                },
                                "required": ["errors", "category"]
                              }
                            },
                            "identifier": {
                              "type": "string",
                              "description": "The activity's iati-identifier for iati-activities files, organisation-identifier for iati-organisations file, or 'file' for file level errors"
                            },
                            "title": {
                              "type": "string",
                              "description": "The activity's title for iati-activities files, the organisation name for iati-organisations files, or 'File level errors' for file level errors"
                            }
                          },
                          "required": ["errors", "identifier", "title"]
                        }
                      }
                    }
                  }
                },
                "example": {
                  "registry_hash": "string",
                  "registry_id": "string",
                  "document_url": "string",
                  "valid": false,
                  "report": {
                    "valid": false,
                    "fileType": "string",
                    "iatiVersion": "string",
                    "rulesetCommitSha": "string",
                    "codelistCommitSha": "string",
                    "orgIdPrefixFileName": "string",
                    "apiVersion": "string",
                    "summary": {
                      "critical": 0,
                      "error": 0,
                      "warning": 0
                    },
                    "errors": [
                      {
                        "errors": [
                          {
                            "errors": [
                              {
                                "id": "string",
                                "severity": "string",
                                "message": "string",
                                "codelist": "string",
                                "context": [
                                  {
                                    "text": "string"
                                  }
                                ]
                              }
                            ],
                            "category": "string"
                          }
                        ],
                        "identifier": "string",
                        "title": "string"
                      }
                    ]
                  }
                }
              },
              "Existing Report missing query parameter": {
                "type": "object",
                "properties": {
                  "client_error": {
                    "type": "string"
                  }
                },
                "example": {
                  "client_error": "Either the id, url or hash of the document as obtained from the IATI Registry must be supplied as a GET parameter"
                }
              },
              "Existing Report Not Found": {
                "type": "object",
                "properties": {
                  "client_error": {
                    "type": "string"
                  }
                },
                "example": {
                  "client_error": "The requested report does not exist."
                }
              }
            }
          }
        }
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/1622545438727')]",
      "type": "Microsoft.ApiManagement/service/apis/schemas",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-v2')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "Get an existing validation report of a published IATI document known to the IATI Registry by passing either the id, hash or URL of the document, as available from the Registry API.\n\n[GitHub Repository](https://github.com/IATI/validator-services)\n\n[Error ID Information](https://github.com/IATI/validator-rule-tracker)\n",
        "request": {
          "queryParameters": [
            {
              "name": "id",
              "description": "id of the published document for which you want a validation report, as provided by the Registry API",
              "type": "string",
              "required": false,
              "values": []
            },
            {
              "name": "url",
              "description": "url of the published document for which you want a validation report, as provided by the Registry API",
              "type": "string",
              "required": false,
              "values": []
            },
            {
              "name": "hash",
              "description": "hash of the published document for which you want a validation report, as provided by the Registry API",
              "type": "string",
              "required": false,
              "values": []
            }
          ],
          "headers": [
            {
              "name": "Accept",
              "type": "string",
              "defaultValue": "application/json",
              "required": false,
              "values": ["application/json"]
            }
          ],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 422,
            "description": "Response if id, url or hash is not provided as a query parameter.",
            "headers": [
              {
                "name": "Content-Type",
                "description": "content type of the response",
                "type": "string",
                "defaultValue": "application/json",
                "required": true,
                "values": ["application/json"]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"client_error\": \"Either the id, url or hash of the document as obtained from the IATI Registry must be supplied as a GET parameter\"\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Existing Report missing query parameter"
              }
            ]
          },
          {
            "statusCode": 404,
            "description": "Response if a report cannot be found for the supplied id, url or hash.",
            "headers": [
              {
                "name": "Content-Type",
                "description": "content type of response",
                "type": "string",
                "defaultValue": "application/json",
                "required": true,
                "values": ["application/json"]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"client_error\": \"The requested report does not exist.\"\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Existing Report Not Found"
              }
            ]
          },
          {
            "statusCode": 200,
            "description": "Response if a report is found and returned.",
            "headers": [
              {
                "name": "Content-Type",
                "description": "content type of the response",
                "type": "string",
                "defaultValue": "application/json",
                "required": true,
                "values": ["application/json"]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"registry_hash\": \"string\",\r\n  \"registry_id\": \"string\",\r\n  \"document_url\": \"string\",\r\n  \"valid\": false,\r\n  \"report\": {\r\n    \"valid\": false,\r\n    \"fileType\": \"string\",\r\n    \"iatiVersion\": \"string\",\r\n    \"rulesetCommitSha\": \"string\",\r\n    \"codelistCommitSha\": \"string\",\r\n    \"orgIdPrefixFileName\": \"string\",\r\n    \"apiVersion\": \"string\",\r\n    \"summary\": {\r\n      \"critical\": 0,\r\n      \"error\": 0,\r\n      \"warning\": 0\r\n    },\r\n    \"errors\": [\r\n      {\r\n        \"errors\": [\r\n          {\r\n            \"errors\": [\r\n              {\r\n                \"id\": \"string\",\r\n                \"severity\": \"string\",\r\n                \"message\": \"string\",\r\n                \"codelist\": \"string\",\r\n                \"context\": [\r\n                  {\r\n                    \"text\": \"string\"\r\n                  }\r\n                ]\r\n              }\r\n            ],\r\n            \"category\": \"string\"\r\n          }\r\n        ],\r\n        \"identifier\": \"string\",\r\n        \"title\": \"string\"\r\n      }\r\n    ]\r\n  }\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Validation Report Published File"
              }
            ]
          }
        ],
        "displayName": "Existing Report",
        "method": "GET",
        "urlTemplate": "/report"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/get-pub-get-report')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-v2')]",
        "[resourceId('Microsoft.ApiManagement/service/apis/schemas', parameters('ApimServiceName'), 'iati-validator-v2', '1622545438727')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/iati-validator-v2-get-pub-get-report-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/get-pub-get-report/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'iati-validator-v2', 'get-pub-get-report')]"
      ]
    },
    {
      "properties": {
        "displayName": "validator"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/get-pub-get-report/validator')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/tags",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'iati-validator-v2', 'get-pub-get-report')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "This route allows the user to POST an IATI document to the Validator in the body of the request, and receive a JSON validation report in the response.\n\n[GitHub Repository](https://github.com/IATI/js-validator-api)  \n\n[Error ID Information](https://github.com/IATI/validator-rule-tracker)\n",
        "request": {
          "description": "IATI XML document (organisations or activities)",
          "queryParameters": [
            {
              "name": "group",
              "description": "group errors by activity (or organisation) and category. Defaults to true if left blank. Set to false to ungroup errors.",
              "type": "string",
              "required": false,
              "values": ["true", "false"]
            },
            {
              "name": "details",
              "description": "show all available details of errors. Defaults to false if left blank. Set to true to see all details. ",
              "type": "string",
              "required": false,
              "values": ["false", "true"]
            }
          ],
          "headers": [
            {
              "name": "Content-Type",
              "description": "Indicates the content type of the request body",
              "type": "string",
              "required": true,
              "values": ["application/xml"]
            },
            {
              "name": "Accept",
              "type": "string",
              "defaultValue": "application/json",
              "required": true,
              "values": ["application/json"]
            }
          ],
          "representations": [
            {
              "contentType": "application/xml",
              "sample": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<iati-organisations version=\"2.02\" generated-datetime=\"2018-11-07T05:25:55+00:00\">\n  <iati-organisation last-updated-datetime=\"2018-11-07T05:25:55+00:00\" xml:lang=\"en\" default-currency=\"NPR\" xmlns:aidstream=\"http://example.org/aidstream/ns#\">\n    <organisation-identifier>NP-SWC-1234</organisation-identifier>\n    <name>\n      <narrative>Test Org Nepal</narrative>\n    </name>\n    <reporting-org type=\"24\" ref=\"NP-SWC-1234\">\n      <narrative>Test Org Nepal</narrative>\n    </reporting-org>\n    <recipient-country-budget status=\"2\">\n      <recipient-country code=\"AF\" />\n      <period-start iso-date=\"2014-01-01\" />\n      <period-end iso-date=\"2014-12-31\" />\n      <value currency=\"USD\" value-date=\"2014-01-01\">25000000</value>\n      <budget-line ref=\"1234\">\n       <value currency=\"USD\" value-date=\"2014-01-01\">2000000</value>\n       <narrative>Budget Line</narrative>\n      </budget-line>\n     </recipient-country-budget>\n  </iati-organisation>\n</iati-organisations>\n"
            },
            {
              "contentType": "application/xml",
              "sample": "<?xml version='1.0' encoding='UTF-8'?>\n<!--This is example XML for the IATI activity standard.  No reference to actual data, real organisations or development cooperation models is intended.-->\n\n<!--iati-activities starts-->\n<iati-activities generated-datetime=\"2014-09-10T07:15:37Z\" version=\"2.03\" linked-data-default=\"http://data.example.org/\">\n\n <!--iati-activity starts-->\n <iati-activity xml:lang=\"en\" default-currency=\"USD\" last-updated-datetime=\"2014-09-10T07:15:37Z\" humanitarian=\"1\" linked-data-uri=\"http://data.example.org/123456789\" hierarchy=\"1\" budget-not-provided=\"1\">\n\n  <!--iati-identifier starts-->\n  <iati-identifier>AA-AAA-123456789-ABC123</iati-identifier>\n  <!--iati-identifier ends-->\n\n  <!--reporting-org starts-->\n  <reporting-org ref=\"AA-AAA-123456789\" type=\"40\" secondary-reporter=\"0\">\n   <narrative>Organisation name</narrative>\n   <narrative xml:lang=\"fr\">Nom de l'organisme</narrative>\n  </reporting-org>\n  <!--reporting-org ends-->\n\n  <!--title starts-->\n  <title>\n   <narrative>Activity title</narrative>\n   <narrative xml:lang=\"fr\">Titre de l'activité</narrative>\n   <narrative xml:lang=\"es\">Título de la actividad</narrative>\n  </title>\n  <!--title ends-->\n\n  <!--description starts-->\n  <description type=\"1\">\n   <narrative>General activity description text.  Long description of the activity with no particular structure.</narrative>\n   <narrative xml:lang=\"fr\">Activité générale du texte de description. Longue description de l'activité sans structure particulière.</narrative>\n  </description>\n  <description type=\"2\">\n   <narrative>Objectives for the activity, for example from a logical framework.</narrative>\n   <narrative xml:lang=\"fr\">Objectifs de l'activité, par exemple à partir d'un cadre logique.</narrative>\n  </description>\n  <description type=\"3\">\n   <narrative>Statement of groups targeted to benefit from the activity.</narrative>\n   <narrative xml:lang=\"fr\">Déclaration de groupes ciblés pour bénéficier de l'activité.</narrative>\n  </description>\n  <!--description ends-->\n\n  <!--participating-org starts-->\n  <participating-org ref=\"BB-BBB-123456789\" role=\"1\" type=\"40\" activity-id=\"BB-BBB-123456789-1234\">\n   <narrative>Name of Agency B</narrative>\n  </participating-org>\n  <participating-org ref=\"CC-CCC-123456789\" role=\"2\" type=\"10\" activity-id=\"CC-CCC-123456789-1234\">\n   <narrative>Name of Agency C</narrative>\n  </participating-org>\n  <participating-org ref=\"AA-AAA-123456789\" role=\"3\" type=\"21\" activity-id=\"AA-AAA-123456789-1234\" crs-channel-code=\"10000\">\n   <narrative>Name of Agency A</narrative>\n   <narrative xml:lang=\"fr\">Nom de l'agence A</narrative>\n  </participating-org>\n  <!--participating-org ends-->\n\n  <!--other-identifier starts-->\n  <other-identifier ref=\"ABC123-XYZ\" type=\"A1\">\n   <owner-org ref=\"AA-AAA-123456789\">\n    <narrative>Organisation name</narrative>\n   </owner-org>\n  </other-identifier>\n  <!--other-identifier ends-->\n\n  <!--activity-status starts-->\n  <activity-status code=\"2\" />\n  <!--activity-status ends-->\n\n  <!--activity-date starts-->\n  <activity-date iso-date=\"2012-04-15\" type=\"1\">\n   <narrative>Planned start date of the activity</narrative>\n   <narrative xml:lang=\"fr\">Date prévue de début de l'activité</narrative>\n  </activity-date>\n  <activity-date iso-date=\"2012-04-28\" type=\"2\" />\n  <activity-date iso-date=\"2015-12-31\" type=\"3\" />\n  <!--activity-date ends-->\n\n  <!--contact-info starts-->\n  <contact-info type=\"1\">\n   <organisation>\n    <narrative>Agency A</narrative>\n   </organisation>\n   <department>\n    <narrative>Department B</narrative>\n   </department>\n   <person-name>\n    <narrative>A. Example</narrative>\n   </person-name>\n   <job-title>\n    <narrative>Transparency Lead</narrative>\n   </job-title>\n   <telephone>0044111222333444</telephone>\n   <email>transparency@example.org</email>\n   <website>http://www.example.org</website>\n   <mailing-address>\n    <narrative>Transparency House, The Street, Town, City, Postcode</narrative>\n   </mailing-address>\n  </contact-info>\n  <!--contact-info ends-->\n\n  <!--activity-scope starts-->\n  <activity-scope code=\"3\" />\n  <!--activity-scope ends-->\n\n  <!--recipient-country starts-->\n  <recipient-country code=\"AF\" percentage=\"25\" />\n  <recipient-country code=\"AG\" percentage=\"25\" />\n  <!--recipient-country ends-->\n\n  <!--recipient-region starts-->\n  <recipient-region code=\"489\" vocabulary=\"1\" percentage=\"50\" />\n  <recipient-region code=\"A1\" vocabulary=\"99\" vocabulary-uri=\"http://example.com/vocab.html\" percentage=\"50\" />\n  <!--recipient-region ends-->\n\n  <!--location-single starts-->\n  <location ref=\"AF-KAN\">\n   <location-reach code=\"1\" />\n   <location-id vocabulary=\"G1\" code=\"1453782\" />\n   <name>\n  <narrative>Location name</narrative>\n   </name>\n   <description>\n  <narrative>Location description</narrative>\n   </description>\n   <activity-description>\n  <narrative>A description that qualifies the activity taking place at the location.</narrative>\n   </activity-description>\n   <administrative vocabulary=\"G1\" level=\"1\" code=\"1453782\" />\n   <point srsName=\"http://www.opengis.net/def/crs/EPSG/0/4326\">\n    <pos>31.616944 65.716944</pos>\n   </point>\n   <exactness code=\"1\"/>\n   <location-class code=\"2\"/>\n   <feature-designation code=\"ADMF\"/>\n  </location>\n  <!--location-single ends-->\n\n  <!--location-additional starts-->\n  <location ref=\"KH-PNH\">\n   <location-reach code=\"1\" />\n   <location-id vocabulary=\"G1\" code=\"1821306\" />\n   <name>\n  <narrative>Location #2 name</narrative>\n   </name>\n   <description>\n  <narrative>Location #2 description</narrative>\n   </description>\n   <activity-description>\n  <narrative>A description that qualifies the activity taking place at location #2</narrative>\n   </activity-description>\n   <administrative vocabulary=\"G1\" level=\"1\" code=\"1453782\" />\n   <point srsName=\"http://www.opengis.net/def/crs/EPSG/0/4326\">\n    <pos>11.5500 104.9167</pos>\n   </point>\n   <exactness code=\"1\" />\n   <location-class code=\"2\" />\n   <feature-designation code=\"ADMF\" />\n  </location>\n  <!--location-additional ends-->\n\n  <!--sector starts-->\n  <sector vocabulary=\"1\" code=\"11110\" percentage=\"50\" />\n  <sector vocabulary=\"1\" code=\"11230\" percentage=\"50\" />\n  <sector vocabulary=\"98\" vocabulary-uri=\"http://example.com/vocab.html\" code=\"A1\" percentage=\"100\">\n   <narrative>Code A1</narrative>\n  </sector>\n  <!--sector ends-->\n\n  <!--tag starts-->\n  <tag vocabulary=\"1\" code=\"1\">\n    <narrative>A description of the tag</narrative>\n  </tag>\n  <tag vocabulary=\"99\" vocabulary-uri=\"http://example.com/vocab.html\" code=\"T1\">\n    <narrative>A description of the tag</narrative>\n  </tag>\n  <!--tag ends-->\n\n  <!--country-budget-items starts-->\n  <country-budget-items vocabulary=\"4\">\n   <budget-item code=\"1844\" percentage=\"50\">\n    <description>\n     <narrative>Description text</narrative>\n    </description>\n   </budget-item>\n   <budget-item code=\"1900\" percentage=\"50\">\n    <description>\n     <narrative>Description text</narrative>\n    </description>\n   </budget-item>\n  </country-budget-items>\n  <!--country-budget-items ends-->\n\n  <!--humanitarian-scope starts-->\n  <humanitarian-scope type=\"1\" vocabulary=\"1-2\" code=\"EQ-2015-000048-NPL\">\n \t  <narrative>Nepal Earthquake April 2015</narrative>\n    <narrative xml:lang=\"fr\"> Népal Earthquake Avril 2015</narrative>\n  </humanitarian-scope>\n  <humanitarian-scope type=\"1\" vocabulary=\"99\" vocabulary-uri=\"http://example.com/vocab.html\" code=\"A1\">\n   <narrative xml:lang=\"en\">Nepal Earthquake April 2015</narrative>\n  </humanitarian-scope>\n  <!--humanitarian-scope ends-->\n\n  <!--policy-marker starts-->\n  <policy-marker vocabulary=\"1\" code=\"2\" significance=\"3\" />\n  <policy-marker vocabulary=\"1\" code=\"9\" significance=\"4\" />\n  <policy-marker vocabulary=\"99\" vocabulary-uri=\"http://example.com/vocab.html\" code=\"A1\" significance=\"3\">\n   <narrative>Code A1</narrative>\n  </policy-marker>\n  <!--policy-marker ends-->\n\n  <!--collaboration-type starts-->\n  <collaboration-type code=\"1\" />\n  <!--collaboration-type ends-->\n\n  <!--default-flow-type starts-->\n  <default-flow-type code=\"10\" />\n  <!--default-flow-type ends-->\n\n  <!--default-finance-type starts-->\n  <default-finance-type code=\"110\" />\n  <!--default-finance-type ends-->\n\n  <!--default-aid-type starts-->\n  <default-aid-type code=\"A01\" vocabulary=\"1\" />\n  <default-aid-type code=\"1\" vocabulary=\"2\" />\n  <!--default-aid-type ends-->\n\n  <!--default-tied-status starts-->\n  <default-tied-status code=\"3\" />\n  <!--default-tied-status ends-->\n\n  <!--budget starts-->\n  <budget type=\"1\" status=\"1\">\n   <period-start iso-date=\"2014-01-01\" />\n   <period-end iso-date=\"2014-12-31\" />\n   <value currency=\"EUR\" value-date=\"2014-01-01\">3000</value>\n  </budget>\n  <!--budget ends-->\n\n  <!--planned-disbursement starts-->\n  <planned-disbursement type=\"1\">\n   <period-start iso-date=\"2014-01-01\" />\n   <period-end iso-date=\"2014-12-31\" />\n   <value currency=\"EUR\" value-date=\"2014-01-01\">3000</value>\n   <provider-org provider-activity-id=\"BB-BBB-123456789-1234AA\" type=\"10\" ref=\"BB-BBB-123456789\">\n    <narrative>Agency B</narrative>\n   </provider-org>\n   <receiver-org receiver-activity-id=\"AA-AAA-123456789-1234\" type=\"23\" ref=\"AA-AAA-123456789\">\n    <narrative>Agency A</narrative>\n   </receiver-org>\n  </planned-disbursement>\n  <!--planned-disbursement ends-->\n\n  <!--planned-disbursement-single-date starts-->\n  <planned-disbursement type=\"1\">\n   <period-start iso-date=\"2014-01-01\" />\n   <period-end iso-date=\"2014-12-31\" />\n   <value currency=\"EUR\" value-date=\"2014-01-01\">3000</value>\n  </planned-disbursement>\n  <!--planned-disbursement ends-->\n\n  <!--capital-spend starts-->\n  <capital-spend percentage=\"88.8\" />\n  <!--capital-spend ends-->\n\n  <!--transaction starts-->\n  <transaction ref=\"1234\" humanitarian=\"1\">\n   <transaction-type code=\"1\" />\n   <transaction-date iso-date=\"2012-01-01\" />\n   <value currency=\"EUR\" value-date=\"2012-01-01\">1000</value>\n   <description>\n    <narrative>Transaction description text</narrative>\n   </description>\n   <provider-org provider-activity-id=\"BB-BBB-123456789-1234AA\" type=\"10\" ref=\"BB-BBB-123456789\">\n    <narrative>Agency B</narrative>\n   </provider-org>\n   <receiver-org receiver-activity-id=\"AA-AAA-123456789-1234\" type=\"23\" ref=\"AA-AAA-123456789\">\n    <narrative>Agency A</narrative>\n   </receiver-org>\n   <disbursement-channel code=\"1\" />\n   <!--Note: only a recipient-region OR a recipient-country is expected-->\n   <flow-type code=\"10\" />\n   <finance-type code=\"110\" />\n   <aid-type code=\"A01\" vocabulary=\"1\" />\n   <aid-type code=\"1\" vocabulary=\"2\" />\n   <tied-status code=\"3\" />\n  </transaction>\n  <!--transaction ends-->\n\n  <!--document-link starts-->\n  <document-link format=\"application/vnd.oasis.opendocument.text\" url=\"http:www.example.org/docs/report_en.odt\">\n   <title>\n    <narrative>Project Report 2013</narrative>\n    <narrative xml:lang=\"fr\">Rapport de projet 2013</narrative>\n   </title>\n   <description>\n     <narrative> Description of the content of the project report or guidance on where to access the relevant information in this report </narrative>\n   </description>\n   <category code=\"A01\" />\n   <language code=\"en\" />\n   <document-date iso-date=\"2014-02-05\" />\n  </document-link>\n  <!--document-link ends-->\n\n  <!--related-activity starts-->\n  <related-activity ref=\"AA-AAA-123456789-6789\" type=\"1\" />\n  <!--related-activity ends-->\n\n  <!--legacy-data starts-->\n  <legacy-data name=\"Project Status\" value=\"7\" iati-equivalent=\"activity-status\" />\n  <legacy-data name=\"cost\" value=\"1000\" iati-equivalent=\"transaction\" />\n  <!--legacy-data ends-->\n\n  <!--conditions starts-->\n  <conditions attached=\"1\">\n   <condition type=\"1\">\n    <narrative>Conditions text</narrative>\n    <narrative xml:lang=\"fr\">Conditions texte</narrative>\n   </condition>\n  </conditions>\n  <!--conditions ends-->\n\n  <!--result starts-->\n  <result type=\"1\" aggregation-status=\"1\">\n   <title>\n    <narrative>Result title</narrative>\n   </title>\n   <description>\n    <narrative>Result description text</narrative>\n   </description>\n   <!--result-document-link example starts-->\n   <document-link format=\"application/vnd.oasis.opendocument.text\" url=\"http:www.example.org/docs/result_en.odt\">\n    <title>\n     <narrative>Results Report 2013</narrative>\n    </title>\n    <description>\n      <narrative>Report of results</narrative>\n    </description>\n    <category code=\"A01\" />\n    <language code=\"en\" />\n    <document-date iso-date=\"2014-02-05\" />\n   </document-link>\n<!--result-document-link example ends-->\n<!--result-reference starts-->\n<!--   <reference vocabulary=\"99\" code=\"B1\" vocabulary-uri=\"http://example.com/indicators.html\" />-->\n<!--result-reference ends-->\n<!--result-indicator starts-->\n   <indicator measure=\"1\" ascending=\"1\" aggregation-status=\"1\">\n     <title>\n      <narrative>Indicator title</narrative>\n     </title>\n     <description>\n      <narrative>Indicator description text</narrative>\n     </description>\n     <document-link format=\"application/vnd.oasis.opendocument.text\" url=\"http:www.example.org/docs/result_indicator_en.odt\">\n      <title>\n       <narrative>Results Indicator Report 2013</narrative>\n      </title>\n      <description>\n        <narrative>Report of results indicator</narrative>\n      </description>\n      <category code=\"A01\" />\n      <language code=\"en\" />\n      <document-date iso-date=\"2014-02-05\" />\n     </document-link>\n     <reference vocabulary=\"1\" code=\"3429\" />\n     <reference vocabulary=\"7\" code=\"861\" />\n     <reference vocabulary=\"99\" code=\"B1\" indicator-uri=\"http://example.com/indicators.html\" />\n<!--result-baseline starts-->\n     <baseline year=\"2012\" iso-date=\"2012-01-01\" value=\"10\">\n      <location ref=\"AF-KAN\" />\n      <location ref=\"KH-PNH\" />\n      <dimension name=\"sex\" value=\"female\" />\n      <dimension name=\"age\" value=\"adult\" />\n      <document-link format=\"application/vnd.oasis.opendocument.text\" url=\"http:www.example.org/docs/result_baseline_en.odt\">\n       <title>\n        <narrative>Results Baseline Report 2013</narrative>\n       </title>\n       <description>\n         <narrative>Report of results baseline</narrative>\n       </description>\n       <category code=\"A01\" />\n       <language code=\"en\" />\n       <document-date iso-date=\"2014-02-05\" />\n      </document-link>\n      <comment>\n       <narrative>Baseline comment text</narrative>\n      </comment>\n     </baseline>\n     <!--result-baseline ends-->\n     <!--result-period starts-->\n     <period>\n      <period-start iso-date=\"2013-01-01\" />\n      <period-end iso-date=\"2013-03-31\" />\n      <target value=\"10\">\n       <location ref=\"AF-KAN\" />\n       <location ref=\"KH-PNH\" />\n       <dimension name=\"sex\" value=\"female\" />\n       <dimension name=\"age\" value=\"adult\" />\n       <comment>\n        <narrative>Target comment text</narrative>\n       </comment>\n       <document-link format=\"application/vnd.oasis.opendocument.text\" url=\"http:www.example.org/docs/result_period_target_en.odt\">\n        <title>\n         <narrative>Results Period Target Report 2013</narrative>\n        </title>\n        <description>\n          <narrative>Report of results period target</narrative>\n        </description>\n        <category code=\"A01\" />\n        <language code=\"en\" />\n        <document-date iso-date=\"2014-02-05\" />\n       </document-link>\n      </target>\n      <actual value=\"11\">\n       <location ref=\"AF-KAN\" />\n       <location ref=\"KH-PNH\" />\n       <dimension name=\"sex\" value=\"female\" />\n       <dimension name=\"age\" value=\"adult\" />\n       <comment>\n         <narrative>Actual comment text</narrative>\n       </comment>\n       <document-link format=\"application/vnd.oasis.opendocument.text\" url=\"http:www.example.org/docs/result_period_actual_en.odt\">\n        <title>\n         <narrative>Results Period Actual Report 2013</narrative>\n        </title>\n        <description>\n          <narrative>Report of results period actual</narrative>\n        </description>\n        <category code=\"A01\" />\n        <language code=\"en\" />\n        <document-date iso-date=\"2014-02-05\" />\n       </document-link>\n      </actual>\n     </period>\n     <!--result-period ends-->\n   </indicator>\n   <!--result-indicator ends-->\n  </result>\n  <!--result ends-->\n\n  <!--crs-add starts-->\n  <crs-add>\n   <other-flags code=\"1\" significance=\"1\" />\n   <loan-terms rate-1=\"4\" rate-2=\"3\">\n    <repayment-type code=\"1\" />\n    <repayment-plan code=\"4\" />\n    <commitment-date iso-date=\"2013-09-01\"/>\n    <repayment-first-date iso-date=\"2014-01-01\" />\n    <repayment-final-date iso-date=\"2020-12-31\" />\n   </loan-terms>\n   <loan-status year=\"2014\" currency=\"GBP\" value-date=\"2013-05-24\">\n     <interest-received>200000</interest-received>\n     <principal-outstanding>1500000</principal-outstanding>\n     <principal-arrears>0</principal-arrears>\n     <interest-arrears>0</interest-arrears>\n   </loan-status>\n   <channel-code>21039</channel-code>\n  </crs-add>\n  <!--crs-add ends-->\n\n  <!--fss starts-->\n  <fss extraction-date=\"2014-05-06\" priority=\"1\" phaseout-year=\"2016\">\n   <forecast year=\"2014\" value-date=\"2013-07-03\" currency=\"GBP\">10000</forecast>\n  </fss>\n  <!--fss ends-->\n\n </iati-activity>\n  <!--iati-activity ends-->\n\n</iati-activities>\n<!--iati-activities ends-->\n"
            }
          ]
        },
        "responses": [
          {
            "statusCode": 400,
            "description": "The body is either not present or is malformed.",
            "headers": [
              {
                "name": "Content-Type",
                "description": "content type",
                "type": "string",
                "defaultValue": "application/json",
                "required": false,
                "values": ["application/json"]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"error\": \"No body\"\r\n}",
                "schemaId": "1622545438727",
                "typeName": "No Body Error"
              },
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"error\": \"Body must be an application/xml string\"\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Malformed Body Error"
              },
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"valid\": false,\r\n  \"fileType\": \"string\",\r\n  \"iatiVersion\": \"string\",\r\n  \"rulesetCommitSha\": \"string\",\r\n  \"codelistCommitSha\": \"string\",\r\n  \"orgIdPrefixFileName\": \"string\",\r\n  \"apiVersion\": \"string\",\r\n  \"summary\": {\r\n    \"critical\": 0,\r\n    \"error\": 0,\r\n    \"warning\": 0\r\n  },\r\n  \"errors\": [\r\n    {\r\n      \"errors\": [\r\n        {\r\n          \"errors\": [\r\n            {\r\n              \"id\": \"string\",\r\n              \"severity\": \"string\",\r\n              \"message\": \"string\",\r\n              \"codelist\": \"string\",\r\n              \"context\": [\r\n                {\r\n                  \"text\": \"string\"\r\n                }\r\n              ]\r\n            }\r\n          ],\r\n          \"category\": \"string\"\r\n        }\r\n      ],\r\n      \"identifier\": \"string\",\r\n      \"title\": \"string\"\r\n    }\r\n  ]\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Validation Report Ad Hoc Validate"
              }
            ]
          },
          {
            "statusCode": 422,
            "description": "Content of the body can be interpreted by the application but doesn't make sense for one of the following reasons.\n- Not recognisable as IATI\n- Critical (Schema) Errors\n- Not a supported version of IATI",
            "headers": [
              {
                "name": "Content-Type",
                "description": "content type",
                "type": "string",
                "defaultValue": "application/json",
                "required": false,
                "values": ["application/json"]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"valid\": false,\r\n  \"fileType\": \"string\",\r\n  \"iatiVersion\": \"string\",\r\n  \"rulesetCommitSha\": \"string\",\r\n  \"codelistCommitSha\": \"string\",\r\n  \"orgIdPrefixFileName\": \"string\",\r\n  \"apiVersion\": \"string\",\r\n  \"summary\": {\r\n    \"critical\": 0,\r\n    \"error\": 0,\r\n    \"warning\": 0\r\n  },\r\n  \"errors\": [\r\n    {\r\n      \"errors\": [\r\n        {\r\n          \"errors\": [\r\n            {\r\n              \"id\": \"string\",\r\n              \"severity\": \"string\",\r\n              \"message\": \"string\",\r\n              \"codelist\": \"string\",\r\n              \"context\": [\r\n                {\r\n                  \"text\": \"string\"\r\n                }\r\n              ]\r\n            }\r\n          ],\r\n          \"category\": \"string\"\r\n        }\r\n      ],\r\n      \"identifier\": \"string\",\r\n      \"title\": \"string\"\r\n    }\r\n  ]\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Validation Report Ad Hoc Validate"
              }
            ]
          },
          {
            "statusCode": 200,
            "description": "No Critical errors were detected with the IATI document and validation was successful. There may be validation errors of severity \"error\" or \"warning\" with the document.",
            "headers": [
              {
                "name": "Content-Type",
                "description": "content type",
                "type": "string",
                "defaultValue": "application/json",
                "required": false,
                "values": ["application/json"]
              }
            ],
            "representations": [
              {
                "contentType": "application/json",
                "sample": "{\r\n  \"valid\": false,\r\n  \"fileType\": \"string\",\r\n  \"iatiVersion\": \"string\",\r\n  \"rulesetCommitSha\": \"string\",\r\n  \"codelistCommitSha\": \"string\",\r\n  \"orgIdPrefixFileName\": \"string\",\r\n  \"apiVersion\": \"string\",\r\n  \"summary\": {\r\n    \"critical\": 0,\r\n    \"error\": 0,\r\n    \"warning\": 0\r\n  },\r\n  \"errors\": [\r\n    {\r\n      \"errors\": [\r\n        {\r\n          \"errors\": [\r\n            {\r\n              \"id\": \"string\",\r\n              \"severity\": \"string\",\r\n              \"message\": \"string\",\r\n              \"codelist\": \"string\",\r\n              \"context\": [\r\n                {\r\n                  \"text\": \"string\"\r\n                }\r\n              ]\r\n            }\r\n          ],\r\n          \"category\": \"string\"\r\n        }\r\n      ],\r\n      \"identifier\": \"string\",\r\n      \"title\": \"string\"\r\n    }\r\n  ]\r\n}",
                "schemaId": "1622545438727",
                "typeName": "Validation Report Ad Hoc Validate"
              }
            ]
          }
        ],
        "displayName": "Validate",
        "method": "POST",
        "urlTemplate": "/validate"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/post-pub-validate-post')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-v2')]",
        "[resourceId('Microsoft.ApiManagement/service/apis/schemas', parameters('ApimServiceName'), 'iati-validator-v2', '1622545438727')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/iati-validator-v2-post-pub-validate-post-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/post-pub-validate-post/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'iati-validator-v2', 'post-pub-validate-post')]"
      ]
    },
    {
      "properties": {
        "displayName": "validator"
      },
      "name": "[concat(parameters('ApimServiceName'), '/iati-validator-v2/post-pub-validate-post/validator')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/tags",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'iati-validator-v2', 'post-pub-validate-post')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/exploratory/iati-validator-v2')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-v2')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/unlimited/iati-validator-v2')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'iati-validator-v2')]"
      ]
    },
    {
      "properties": {
        "description": "Passthrough to Solr API",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": false,
        "displayName": "SOLR Private",
        "serviceUrl": "[parameters('serviceUrl').solr]",
        "path": "solr",
        "protocols": ["https"]
      },
      "name": "[concat(parameters('ApimServiceName'), '/solr')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": []
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "GET Passthrough",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "description": "null",
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "GET Passthrough",
        "method": "GET",
        "urlTemplate": "/*"
      },
      "name": "[concat(parameters('ApimServiceName'), '/solr/get-passthrough')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'solr')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/solr-get-passthrough-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/solr/get-passthrough/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'solr', 'get-passthrough')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/solr-apiPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/solr/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'solr')]"
      ]
    },
    {
      "properties": {
        "description": "Import from \"dev-func-validator-services\" Function App",
        "authenticationSettings": {
          "subscriptionKeyRequired": false
        },
        "subscriptionKeyParameterNames": {
          "header": "Ocp-Apim-Subscription-Key",
          "query": "subscription-key"
        },
        "apiRevision": "1",
        "isCurrent": true,
        "subscriptionRequired": true,
        "displayName": "Validator Services Private",
        "serviceUrl": "[parameters('serviceUrl').validatorservicesprivate]",
        "path": "vs",
        "protocols": ["https"]
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private')]",
      "type": "Microsoft.ApiManagement/service/apis",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": []
    },
    {
      "properties": {
        "contentType": "application/vnd.oai.openapi.components+json",
        "document": {
          "components": {
            "schemas": {
              "PvtPublishers-id-DocumentsGetRequest": {
                "x-apim-inline": true
              },
              "PvtPublishers-id-GetRequest": {
                "x-apim-inline": true
              },
              "PvtDocuments-id-GetRequest": {
                "x-apim-inline": true
              },
              "PvtGuidance-links-version-GetRequest": {
                "x-apim-inline": true
              },
              "PvtAdhocSessionGetRequest": {
                "x-apim-inline": true
              }
            }
          }
        }
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/6110dd60217d200e04c7fe43')]",
      "type": "Microsoft.ApiManagement/service/apis/schemas",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pub-get-report",
        "method": "GET",
        "urlTemplate": "/pub/validation/existing"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-report')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pub-get-report-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-report/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pub-get-report')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pub-get-validator-version",
        "method": "GET",
        "urlTemplate": "/pub/validator-version"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-version-1')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pub-get-version-1-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-version-1/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pub-get-version-1')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pub-get-version",
        "method": "GET",
        "urlTemplate": "/pub/version"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-version')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pub-get-version-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pub-get-version/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pub-get-version')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [
          {
            "name": "sessionId",
            "type": "",
            "required": true,
            "values": []
          }
        ],
        "description": "pvt-get-adhoc-session",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": [
            {
              "contentType": "multipart/form-data",
              "formParameters": [
                {
                  "name": "rootNodeName",
                  "type": "string",
                  "required": false,
                  "values": []
                }
              ]
            }
          ]
        },
        "responses": [
          {
            "statusCode": 200,
            "description": "null",
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "pvt-get-adhoc-session",
        "method": "GET",
        "urlTemplate": "/pvt/adhoc/session?sessionId={sessionId}"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/610a46b0342160c523b5a90f')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-610a46b0342160c523b5a90f-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/610a46b0342160c523b5a90f/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', '610a46b0342160c523b5a90f')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [
          {
            "name": "version",
            "type": "",
            "required": true,
            "values": []
          }
        ],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get-guidance-links",
        "method": "GET",
        "urlTemplate": "/pvt/guidance-links/{version}"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-guidance-links')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pvt-get-guidance-links-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-guidance-links/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pvt-get-guidance-links')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get-publishers",
        "method": "GET",
        "urlTemplate": "/pvt/publishers"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-publishers')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pvt-get-publishers-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-publishers/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pvt-get-publishers')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [
          {
            "name": "id",
            "type": "",
            "required": true,
            "values": []
          }
        ],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get-publishers-documents",
        "method": "GET",
        "urlTemplate": "/pvt/publishers/{id}/documents"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-publisher-documents')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pvt-get-publisher-documents-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-publisher-documents/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pvt-get-publisher-documents')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [
          {
            "name": "id",
            "type": "",
            "required": true,
            "values": []
          }
        ],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get-single-document",
        "method": "GET",
        "urlTemplate": "/pvt/documents/{id}"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-single-document')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pvt-get-single-document-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-single-document/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pvt-get-single-document')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [
          {
            "name": "id",
            "type": "",
            "required": true,
            "values": []
          }
        ],
        "description": "",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [],
        "displayName": "pvt-get-single-publisher",
        "method": "GET",
        "urlTemplate": "/pvt/publishers/{id}"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-single-publisher')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-get-pvt-get-single-publisher-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/get-pvt-get-single-publisher/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'get-pvt-get-single-publisher')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "Uploader for adhoc validation",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "description": "null",
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "pvt-post-adhoc-file",
        "method": "POST",
        "urlTemplate": "/pvt/adhoc/upload"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/pvt-post-adhoc-file')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-pvt-post-adhoc-file-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/pvt-post-adhoc-file/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', 'pvt-post-adhoc-file')]"
      ]
    },
    {
      "properties": {
        "templateParameters": [],
        "description": "URL poster for adhoc validation",
        "request": {
          "queryParameters": [],
          "headers": [],
          "representations": []
        },
        "responses": [
          {
            "statusCode": 200,
            "description": "null",
            "headers": [],
            "representations": []
          }
        ],
        "displayName": "pvt-post-adhoc-url",
        "method": "POST",
        "urlTemplate": "/pvt/adhoc/url"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/6114e44dd2a66d17c80f78ce')]",
      "type": "Microsoft.ApiManagement/service/apis/operations",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-6114e44dd2a66d17c80f78ce-operationPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/6114e44dd2a66d17c80f78ce/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/operations/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis/operations', parameters('ApimServiceName'), 'validator-services-private', '6114e44dd2a66d17c80f78ce')]"
      ]
    },
    {
      "properties": {
        "value": "[concat(parameters('PolicyXMLBaseUrl'), '/validator-services-private-apiPolicy.xml')]",
        "format": "rawxml-link"
      },
      "name": "[concat(parameters('ApimServiceName'), '/validator-services-private/policy')]",
      "type": "Microsoft.ApiManagement/service/apis/policies",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    },
    {
      "name": "[concat(parameters('ApimServiceName'), '/private-routes/validator-services-private')]",
      "type": "Microsoft.ApiManagement/service/products/apis",
      "apiVersion": "2021-01-01-preview",
      "dependsOn": [
        "[resourceId('Microsoft.ApiManagement/service/apis', parameters('ApimServiceName'), 'validator-services-private')]"
      ]
    }
  ]
}
